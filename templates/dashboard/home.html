{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard - Whole Life Journey{% endblock %}

{% block content %}
<div class="container">
    <!-- Greeting -->
    <header class="dashboard-header">
        <div class="greeting">
            <h1>{{ greeting }}, {{ user.get_short_name }}.</h1>
            <p class="current-date">{{ current_date|date:"l, F j, Y" }}</p>
        </div>
        <div class="quick-actions">
            <a href="{% url 'journal:entry_create' %}" class="btn btn-primary">
                <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14"/>
                </svg>
                New Entry
            </a>
        </div>
    </header>
    
    <!-- Daily Encouragement -->
    <section class="encouragement-card">
        {% if encouragement %}
            <p class="encouragement-message">{{ encouragement.message }}</p>
            {% if encouragement.scripture_reference and faith_enabled %}
                <p class="scripture-reference">
                    â€” {{ encouragement.scripture_reference }}
                </p>
            {% endif %}
        {% else %}
            <p class="encouragement-message">
                Take a moment to breathe. You're exactly where you need to be.
            </p>
        {% endif %}
    </section>
    
    <!-- Dashboard Tiles -->
    <div class="dashboard-grid">
        <!-- Journal Summary Tile -->
        <div class="dashboard-tile">
            <div class="tile-header">
                <h2 class="tile-title">
                    <svg class="tile-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                    </svg>
                    Journal
                </h2>
                <a href="{% url 'journal:entry_list' %}" class="tile-link">View All</a>
            </div>
            
            <div class="tile-stats">
                <div class="stat">
                    <span class="stat-value">{{ journal_stats.total }}</span>
                    <span class="stat-label">Total Entries</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ journal_stats.this_week }}</span>
                    <span class="stat-label">This Week</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ journal_stats.this_month }}</span>
                    <span class="stat-label">This Month</span>
                </div>
            </div>
            
            {% if journal_stats.recent %}
                <div class="tile-recent">
                    <h3 class="recent-title">Recent Entries</h3>
                    <ul class="recent-list">
                        {% for entry in journal_stats.recent %}
                            <li class="recent-item">
                                <a href="{{ entry.get_absolute_url }}" class="recent-link">
                                    <span class="recent-entry-title">{{ entry.title }}</span>
                                    <span class="recent-entry-date">{{ entry.entry_date|date:"M j" }}</span>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% else %}
                <div class="tile-empty">
                    <p>No journal entries yet.</p>
                    <a href="{% url 'journal:entry_create' %}" class="btn btn-secondary btn-sm">
                        Write Your First Entry
                    </a>
                </div>
            {% endif %}
        </div>
        
        <!-- Quick Actions Tile -->
        <div class="dashboard-tile">
            <div class="tile-header">
                <h2 class="tile-title">
                    <svg class="tile-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    Quick Actions
                </h2>
            </div>
            
            <div class="quick-action-list">
                <a href="{% url 'journal:entry_create' %}" class="quick-action-item">
                    <svg class="quick-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                    <span>New Journal Entry</span>
                </a>
                
                <a href="{% url 'journal:prompt_list' %}" class="quick-action-item">
                    <svg class="quick-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                    <span>Writing Prompts</span>
                </a>
                
                <a href="{% url 'users:preferences' %}" class="quick-action-item">
                    <svg class="quick-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                    </svg>
                    <span>Preferences</span>
                </a>
                
                {% if faith_enabled %}
                <a href="#" class="quick-action-item">
                    <svg class="quick-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v20M2 12h20"/>
                    </svg>
                    <span>Faith Reflections</span>
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
.dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-6);
    flex-wrap: wrap;
    gap: var(--space-4);
}

.greeting h1 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-1);
}

.current-date {
    color: var(--color-text-muted);
    margin: 0;
}

.btn-icon {
    width: 18px;
    height: 18px;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--space-6);
}

.dashboard-tile {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
}

.tile-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.tile-title {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--font-size-lg);
    margin: 0;
}

.tile-icon {
    width: 20px;
    height: 20px;
    color: var(--color-accent);
}

.tile-link {
    font-size: var(--font-size-sm);
    color: var(--color-accent);
}

.tile-stats {
    display: flex;
    gap: var(--space-6);
    margin-bottom: var(--space-4);
    padding-bottom: var(--space-4);
    border-bottom: 1px solid var(--color-border);
}

.stat {
    display: flex;
    flex-direction: column;
}

.stat-value {
    font-size: var(--font-size-2xl);
    font-weight: 600;
    color: var(--color-text);
}

.stat-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
}

.recent-title {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin-bottom: var(--space-2);
}

.recent-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.recent-item {
    margin-bottom: var(--space-2);
}

.recent-link {
    display: flex;
    justify-content: space-between;
    padding: var(--space-2);
    border-radius: var(--radius-md);
    transition: background-color var(--transition-fast);
}

.recent-link:hover {
    background-color: var(--color-surface);
    text-decoration: none;
}

.recent-entry-title {
    color: var(--color-text);
}

.recent-entry-date {
    color: var(--color-text-muted);
    font-size: var(--font-size-sm);
}

.tile-empty {
    text-align: center;
    padding: var(--space-4);
    color: var(--color-text-muted);
}

.tile-empty p {
    margin-bottom: var(--space-4);
}

.quick-action-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.quick-action-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    border-radius: var(--radius-md);
    color: var(--color-text);
    transition: background-color var(--transition-fast);
}

.quick-action-item:hover {
    background-color: var(--color-surface);
    text-decoration: none;
}

.quick-action-icon {
    width: 20px;
    height: 20px;
    color: var(--color-accent);
}
</style>
{% endblock %}
