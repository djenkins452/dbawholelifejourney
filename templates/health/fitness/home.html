{% extends "base.html" %}
{% load static %}

{% block title %}Fitness - Whole Life Journey{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <div>
            <h1 class="page-title">Fitness</h1>
            <p class="page-subtitle">Track your workouts and watch your progress</p>
        </div>
        <a href="{% url 'health:workout_create' %}" class="btn btn-primary">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Start Workout
        </a>
    </div>

    <!-- Quick Stats -->
    <div class="stats-row mb-6">
        <div class="stat-card">
            <span class="stat-value">{{ workouts_this_week }}</span>
            <span class="stat-label">Workouts This Week</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ recent_prs|length }}</span>
            <span class="stat-label">Personal Records</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ templates|length }}</span>
            <span class="stat-label">Saved Templates</span>
        </div>
    </div>

    <div class="fitness-grid">
        <!-- Recent Workouts -->
        <div class="fitness-section">
            <div class="section-header">
                <h2>Recent Workouts</h2>
                <a href="{% url 'health:workout_list' %}" class="section-link">View all</a>
            </div>

            {% if recent_workouts %}
                <div class="workout-list">
                    {% for workout in recent_workouts %}
                        <a href="{% url 'health:workout_detail' workout.pk %}" class="workout-card">
                            <div class="workout-date">
                                <span class="day">{{ workout.date|date:"d" }}</span>
                                <span class="month">{{ workout.date|date:"M" }}</span>
                            </div>
                            <div class="workout-info">
                                <h3>{{ workout.name|default:"Workout" }}</h3>
                                <p>{{ workout.exercise_count }} exercises{% if workout.total_sets %} &bull; {{ workout.total_sets }} sets{% endif %}</p>
                            </div>
                            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <p>No workouts logged yet. Start tracking your fitness journey!</p>
                    <a href="{% url 'health:workout_create' %}" class="btn btn-primary">Log Your First Workout</a>
                </div>
            {% endif %}
        </div>

        <!-- Quick Actions -->
        <div class="fitness-section">
            <div class="section-header">
                <h2>Quick Start</h2>
            </div>

            {% if templates %}
                <div class="template-buttons">
                    {% for template in templates %}
                        <a href="{% url 'health:template_use' template.pk %}" class="template-btn">
                            <span class="template-name">{{ template.name }}</span>
                            <span class="template-exercises">{{ template.exercise_count }} exercises</span>
                        </a>
                    {% endfor %}
                </div>
                <a href="{% url 'health:template_list' %}" class="section-link mt-4">Manage templates</a>
            {% else %}
                <p class="text-muted mb-4">Create templates for your common workout routines</p>
                <a href="{% url 'health:template_create' %}" class="btn btn-secondary">Create Template</a>
            {% endif %}

            <div class="quick-links mt-6">
                <a href="{% url 'health:fitness_progress' %}" class="quick-link">
                    <svg class="quick-link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    View Progress
                </a>
                <a href="{% url 'health:personal_records' %}" class="quick-link">
                    <svg class="quick-link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                    Personal Records
                </a>
            </div>
        </div>

        <!-- Recent PRs -->
        {% if recent_prs %}
        <div class="fitness-section">
            <div class="section-header">
                <h2>Recent PRs</h2>
                <a href="{% url 'health:personal_records' %}" class="section-link">View all</a>
            </div>
            <div class="pr-list">
                {% for pr in recent_prs %}
                    <div class="pr-item">
                        <span class="pr-exercise">{{ pr.exercise.name }}</span>
                        <span class="pr-stats">{{ pr.weight }}lbs x {{ pr.reps }}</span>
                        <span class="pr-date">{{ pr.achieved_date|date:"M j" }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>

    <div class="back-link mt-6">
        <a href="{% url 'health:home' %}">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            Back to Health
        </a>
    </div>
</div>

<style>
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-6);
}

.btn-icon {
    width: 18px;
    height: 18px;
    margin-right: var(--space-2);
}

.stats-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-4);
}

.stat-card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    text-align: center;
}

.stat-card .stat-value {
    display: block;
    font-size: var(--font-size-2xl);
    font-weight: 600;
    color: var(--color-accent);
}

.stat-card .stat-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.fitness-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--space-6);
}

.fitness-section {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.section-header h2 {
    font-size: var(--font-size-lg);
    margin: 0;
}

.section-link {
    font-size: var(--font-size-sm);
    color: var(--color-accent);
}

.workout-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.workout-card {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-3);
    background: var(--color-surface);
    border-radius: var(--radius-md);
    text-decoration: none;
    color: inherit;
    transition: background 0.15s;
}

.workout-card:hover {
    background: var(--color-border);
}

.workout-date {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 40px;
}

.workout-date .day {
    font-size: var(--font-size-xl);
    font-weight: 600;
    line-height: 1;
}

.workout-date .month {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    text-transform: uppercase;
}

.workout-info {
    flex: 1;
}

.workout-info h3 {
    font-size: var(--font-size-base);
    margin: 0 0 var(--space-1) 0;
}

.workout-info p {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin: 0;
}

.chevron {
    width: 16px;
    height: 16px;
    color: var(--color-text-muted);
}

.template-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.template-btn {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-3) var(--space-4);
    background: var(--color-surface);
    border-radius: var(--radius-md);
    text-decoration: none;
    color: inherit;
    transition: background 0.15s;
}

.template-btn:hover {
    background: var(--color-border);
}

.template-name {
    font-weight: 500;
}

.template-exercises {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.quick-links {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    padding-top: var(--space-4);
    border-top: 1px solid var(--color-border);
}

.quick-link {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) 0;
    color: inherit;
    text-decoration: none;
}

.quick-link:hover {
    color: var(--color-accent);
}

.quick-link-icon {
    width: 18px;
    height: 18px;
}

.pr-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.pr-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--color-border);
}

.pr-item:last-child {
    border-bottom: none;
}

.pr-exercise {
    flex: 1;
    font-weight: 500;
}

.pr-stats {
    color: var(--color-accent);
    font-weight: 600;
}

.pr-date {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.empty-state {
    text-align: center;
    padding: var(--space-6);
}

.empty-state p {
    color: var(--color-text-muted);
    margin-bottom: var(--space-4);
}

.back-link a {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    color: var(--color-text-muted);
}

.back-link a:hover {
    color: var(--color-accent);
}

.back-link svg {
    width: 16px;
    height: 16px;
}

@media (max-width: 640px) {
    .page-header {
        flex-direction: column;
        gap: var(--space-4);
    }

    .stats-row {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
