{% extends "base.html" %}

{% block title %}{{ event.title }} - Life{% endblock %}

{% block content %}
<div class="container">
    <nav class="breadcrumb mb-4">
        <a href="{% url 'life:home' %}">Life</a>
        <span>/</span>
        <a href="{% url 'life:significant_event_list' %}">Significant Events</a>
        <span>/</span>
        <span>{{ event.title }}</span>
    </nav>

    <div class="detail-page">
        <div class="detail-header">
            <div class="event-type-icon">
                {% if event.event_type == 'birthday' %}üéÇ
                {% elif event.event_type == 'anniversary' %}üíç
                {% elif event.event_type == 'memorial' %}üïØÔ∏è
                {% elif event.event_type == 'milestone' %}üèÜ
                {% elif event.event_type == 'holiday' %}üéâ
                {% else %}üìÖ{% endif %}
            </div>
            <div class="header-content">
                <h1 class="page-title">{{ event.title }}</h1>
                {% if event.person_name %}
                <p class="person-name">{{ event.person_name }}</p>
                {% endif %}
                <p class="event-type-label">{{ event.get_event_type_display }}</p>
            </div>
            <div class="header-actions">
                <a href="{% url 'life:significant_event_update' event.pk %}" class="btn btn-secondary">Edit</a>
                <a href="{% url 'life:significant_event_delete' event.pk %}" class="btn btn-danger">Delete</a>
            </div>
        </div>

        <div class="detail-grid">
            <div class="detail-card highlight-card">
                <div class="countdown-display">
                    {% if days_until == 0 %}
                    <span class="countdown-number today">Today!</span>
                    <span class="countdown-label">It's happening now!</span>
                    {% elif days_until == 1 %}
                    <span class="countdown-number tomorrow">Tomorrow</span>
                    <span class="countdown-label">Get ready!</span>
                    {% else %}
                    <span class="countdown-number">{{ days_until }}</span>
                    <span class="countdown-label">days until {{ next_occurrence|date:"M d, Y" }}</span>
                    {% endif %}
                </div>
                {% if years_display %}
                <div class="years-display">
                    {{ years_display }} {{ event.get_event_type_display }}
                </div>
                {% endif %}
            </div>

            <div class="detail-card">
                <h3 class="card-title">Event Details</h3>
                <div class="detail-rows">
                    <div class="detail-row">
                        <span class="detail-label">Annual Date</span>
                        <span class="detail-value">{{ event.event_date|date:"F j" }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Next Occurrence</span>
                        <span class="detail-value">{{ next_occurrence|date:"l, F j, Y" }}</span>
                    </div>
                    {% if event.original_year %}
                    <div class="detail-row">
                        <span class="detail-label">Started</span>
                        <span class="detail-value">{{ event.original_year }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="detail-card">
                <h3 class="card-title">SMS Reminders</h3>
                {% if event.sms_reminder_enabled %}
                <div class="reminder-status enabled">
                    <span class="status-icon">‚úì</span>
                    <span>SMS Reminders Enabled</span>
                </div>
                {% if event.reminder_days %}
                <div class="reminder-schedule">
                    <span class="detail-label">Reminder Schedule</span>
                    <ul class="reminder-list">
                        {% for days in event.get_reminder_days_list %}
                        <li>
                            {% if days == 0 %}Day of event
                            {% elif days == 1 %}1 day before
                            {% else %}{{ days }} days before{% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                {% if event.custom_message %}
                <div class="custom-message">
                    <span class="detail-label">Custom Message</span>
                    <p class="message-text">{{ event.custom_message }}</p>
                </div>
                {% endif %}
                {% else %}
                <div class="reminder-status disabled">
                    <span class="status-icon">‚óã</span>
                    <span>SMS Reminders Disabled</span>
                </div>
                <a href="{% url 'life:significant_event_update' event.pk %}" class="btn btn-secondary btn-sm">Enable Reminders</a>
                {% endif %}
            </div>

            {% if event.description %}
            <div class="detail-card full-width">
                <h3 class="card-title">Notes</h3>
                <p class="notes-text">{{ event.description|linebreaks }}</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.detail-page {
    max-width: 800px;
}

.detail-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-5);
    margin-bottom: var(--space-8);
}

.event-type-icon {
    font-size: 3.5rem;
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-surface);
    border-radius: var(--radius-xl);
}

.header-content {
    flex: 1;
}

.header-content .page-title {
    margin: 0 0 var(--space-2) 0;
}

.person-name {
    font-size: var(--font-size-lg);
    color: var(--color-accent);
    margin: 0 0 var(--space-1) 0;
}

.event-type-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin: 0;
}

.header-actions {
    display: flex;
    gap: var(--space-2);
}

.detail-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-5);
}

@media (max-width: 768px) {
    .detail-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .detail-grid {
        grid-template-columns: 1fr;
    }
}

.detail-card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
}

.detail-card.full-width {
    grid-column: 1 / -1;
}

.detail-card.highlight-card {
    background: var(--color-surface);
    text-align: center;
}

.countdown-display {
    margin-bottom: var(--space-4);
}

.countdown-number {
    display: block;
    font-size: 3rem;
    font-weight: 700;
    color: var(--color-accent);
}

.countdown-number.today {
    color: var(--color-success);
}

.countdown-number.tomorrow {
    color: var(--color-warning);
}

.countdown-label {
    display: block;
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.years-display {
    padding-top: var(--space-4);
    border-top: 1px solid var(--color-border);
    font-size: var(--font-size-lg);
    font-weight: 600;
    color: var(--color-accent);
}

.card-title {
    font-size: var(--font-size-base);
    margin: 0 0 var(--space-4) 0;
    padding-bottom: var(--space-3);
    border-bottom: 1px solid var(--color-border);
}

.detail-rows {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.detail-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.detail-value {
    font-weight: 500;
}

.reminder-status {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-4);
}

.reminder-status.enabled {
    background: rgba(34, 197, 94, 0.1);
    color: var(--color-success);
}

.reminder-status.disabled {
    background: var(--color-surface);
    color: var(--color-text-muted);
}

.status-icon {
    font-weight: 700;
}

.reminder-schedule {
    margin-bottom: var(--space-4);
}

.reminder-list {
    list-style: none;
    padding: 0;
    margin: var(--space-2) 0 0 0;
}

.reminder-list li {
    padding: var(--space-1) 0;
    padding-left: var(--space-4);
    position: relative;
}

.reminder-list li::before {
    content: "‚Ä¢";
    position: absolute;
    left: var(--space-1);
    color: var(--color-accent);
}

.custom-message {
    margin-top: var(--space-3);
}

.message-text {
    background: var(--color-surface);
    padding: var(--space-3);
    border-radius: var(--radius-md);
    margin: var(--space-2) 0 0 0;
    font-style: italic;
}

.notes-text {
    margin: 0;
    color: var(--color-text-muted);
}

.btn-sm {
    font-size: var(--font-size-sm);
    padding: var(--space-2) var(--space-3);
}

.btn-danger {
    background-color: var(--color-error);
    color: white;
}

.btn-danger:hover {
    background-color: color-mix(in srgb, var(--color-error) 85%, black);
    color: white;
}
</style>
{% endblock %}
