{% extends "base.html" %}

{% block title %}{% if object %}Edit{% else %}Log{% endif %} Glucose Reading - Health - Whole Life Journey{% endblock %}

{% block content %}
<div class="container max-w-lg">
    <nav class="breadcrumb mb-4">
        <a href="{% url 'health:home' %}">Health</a>
        <span>/</span>
        <a href="{% url 'health:glucose_dashboard' %}">Blood Glucose</a>
        <span>/</span>
        <span>{% if object %}Edit{% else %}Log{% endif %}</span>
    </nav>

    <div class="page-header">
        <h1 class="page-title">{% if object %}Edit Glucose Reading{% else %}Log Glucose Reading{% endif %}</h1>
        <p class="page-subtitle">
            {% if object %}
                Update your blood glucose entry
            {% else %}
                Record a new blood glucose measurement
            {% endif %}
        </p>
    </div>

    <div class="form-card">
        <form method="post">
            {% csrf_token %}

            <div class="form-group">
                <label for="{{ form.value.id_for_label }}" class="form-label">Glucose Reading *</label>
                {{ form.value }}
                {% if form.value.errors %}
                    <p class="form-error">{{ form.value.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.unit.id_for_label }}" class="form-label">Unit</label>
                {{ form.unit }}
            </div>

            <div class="form-group">
                <label for="{{ form.context.id_for_label }}" class="form-label">Context</label>
                {{ form.context }}
                <p class="form-help">When was this reading taken?</p>
            </div>

            <div class="form-group">
                <label for="{{ form.recorded_at.id_for_label }}" class="form-label">Date & Time</label>
                {{ form.recorded_at }}
            </div>

            <div class="form-group">
                <label for="{{ form.notes.id_for_label }}" class="form-label">Notes (optional)</label>
                {{ form.notes }}
                <p class="form-help">Any relevant details (e.g., "after exercise", "felt dizzy")</p>
            </div>

            <div class="form-actions">
                <a href="{% url 'health:glucose_dashboard' %}" class="btn btn-ghost">Cancel</a>
                <button type="submit" class="btn btn-primary">
                    {% if object %}Save Changes{% else %}Log Reading{% endif %}
                </button>
            </div>
        </form>
    </div>

    <!-- Quick Reference -->
    <div class="info-card mt-6">
        <h3 class="info-title">Glucose Ranges (mg/dL)</h3>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label text-error">Very Low</span>
                <span class="info-value">&lt; 54</span>
            </div>
            <div class="info-item">
                <span class="info-label text-warning">Low</span>
                <span class="info-value">54-69</span>
            </div>
            <div class="info-item">
                <span class="info-label text-success">Target Range</span>
                <span class="info-value">70-180</span>
            </div>
            <div class="info-item">
                <span class="info-label text-warning">High</span>
                <span class="info-value">181-250</span>
            </div>
            <div class="info-item">
                <span class="info-label text-error">Very High</span>
                <span class="info-value">&gt; 250</span>
            </div>
        </div>
    </div>
</div>

<style>
.form-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
}

.info-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
}

.info-title {
    font-size: var(--font-size-sm);
    font-weight: 600;
    margin-bottom: var(--space-3);
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: var(--space-3);
}

.info-item {
    text-align: center;
}

.info-label {
    display: block;
    font-size: var(--font-size-xs);
    font-weight: 500;
    margin-bottom: var(--space-1);
}

.info-value {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.text-success { color: var(--color-success); }
.text-warning { color: var(--color-warning); }
.text-error { color: var(--color-error); }
</style>
{% endblock %}
