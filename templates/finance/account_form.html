{% extends "base.html" %}

{% block title %}{% if object %}Edit{% else %}Add{% endif %} Account - Finance - Whole Life Journey{% endblock %}

{% block content %}
<div class="container container-sm">
    <div class="page-header">
        <h1 class="page-title">{% if object %}Edit{% else %}Add{% endif %} Account</h1>
    </div>

    <form method="post" class="form-card">
        {% csrf_token %}

        {% if form.non_field_errors %}
        <div class="form-errors">
            {% for error in form.non_field_errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>
        {% endif %}

        {% if form.errors %}
        <div class="form-errors">
            <p class="form-error"><strong>Please correct the errors below:</strong></p>
            <ul class="error-list">
            {% for field in form %}
                {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
                {% endfor %}
            {% endfor %}
            </ul>
        </div>
        {% endif %}

        <div class="form-group">
            <label for="id_name">Account Name</label>
            {{ form.name }}
            {% if form.name.errors %}
            <p class="form-error">{{ form.name.errors.0 }}</p>
            {% endif %}
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="id_account_type">Account Type</label>
                {{ form.account_type }}
                {% if form.account_type.errors %}
                <p class="form-error">{{ form.account_type.errors.0 }}</p>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="id_institution">Institution</label>
                {{ form.institution }}
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="id_current_balance">Current Balance</label>
                {{ form.current_balance }}
                {% if form.current_balance.errors %}
                <p class="form-error">{{ form.current_balance.errors.0 }}</p>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="id_currency">Currency</label>
                {{ form.currency }}
                {% if form.currency.errors %}
                <p class="form-error">{{ form.currency.errors.0 }}</p>
                {% endif %}
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="id_account_number_last4">Last 4 Digits</label>
                {{ form.account_number_last4 }}
                <p class="form-hint">For identification only</p>
            </div>
            <div class="form-group">
                <label for="id_color">Color</label>
                {{ form.color }}
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="id_sort_order">Sort Order</label>
                {{ form.sort_order }}
                <p class="form-hint">Lower numbers appear first (default: 0)</p>
            </div>
            <div class="form-group">
                <!-- Empty for alignment -->
            </div>
        </div>

        <div class="form-group">
            <label class="checkbox-label">
                {{ form.include_in_net_worth }}
                <span>Include in net worth calculations</span>
            </label>
        </div>

        <div class="form-group">
            <label class="checkbox-label">
                {{ form.is_hidden }}
                <span>Hide from main views</span>
            </label>
        </div>

        <div class="form-group">
            <label for="id_notes">Notes</label>
            {{ form.notes }}
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">{% if object %}Save Changes{% else %}Add Account{% endif %}</button>
            <a href="{% url 'finance:account_list' %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<style>
.container-sm {
    max-width: 600px;
}

.form-card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
}

.form-errors {
    background: #fef2f2;
    border: 1px solid #fecaca;
    border-radius: var(--radius-md);
    padding: var(--space-4);
    margin-bottom: var(--space-4);
}

.error-list {
    margin: var(--space-2) 0 0 var(--space-4);
    padding: 0;
    color: var(--color-error, #dc2626);
}

.form-group {
    margin-bottom: var(--space-4);
}

.form-group label {
    display: block;
    margin-bottom: var(--space-2);
    font-weight: 500;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-4);
}

.form-hint {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin-top: var(--space-1);
}

.form-error {
    color: var(--color-error, #ef4444);
    font-size: var(--font-size-sm);
    margin-top: var(--space-1);
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    cursor: pointer;
}

.form-actions {
    display: flex;
    gap: var(--space-3);
    margin-top: var(--space-6);
    padding-top: var(--space-4);
    border-top: 1px solid var(--color-border);
}

@media (max-width: 640px) {
    .form-row {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
